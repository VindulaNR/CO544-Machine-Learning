#this is lab 02 TODO 1 sumbission
#the compiling done using google colab

# -*- coding: utf-8 -*-
"""CO544_Lab02_ex1.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1TEyQ-o1yMfrzaTqTAU23__trk_H6kVGT
"""

#importing libraries and mount googlr drive to read the csv file
#part (i)

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from google.colab import drive
drive.mount('/content/drive')

pd.set_option('display.min_rows',20)
data=pd.read_csv('/content/drive/My Drive/CO544/Lab02/Boston_Housing.csv')
data

#importing sklearn and split the data set fro 80% and 20%
#part (ii)

from sklearn.model_selection import train_test_split
data_train, data_test = train_test_split(data,test_size=0.2,random_state=0)
data_train

#part (iii)

response_train = data_train["MEDV"]
response_test = data_test["MEDV"]

features_train= data_train.drop('MEDV', axis=1)
features_test= data_test.drop('MEDV', axis=1)

#part (iv)

features_train_transpose = np.transpose(features_train)
para_val = np.dot(np.dot(np.linalg.inv(np.dot(features_train_transpose,features_train)),features_train_transpose),response_train)
para_val

#part (v)

predict_val_test = np.dot(features_test,para_val)
predict_val_test

predict_val_train = np.dot(features_train,para_val)
predict_val_train

error_test = response_test - predict_val_test

error_train = response_train - predict_val_train

#part (vi)
#In here plot the actual value vs predicted value

plt.scatter(predict_val_train, response_train, color ='b', s=5)
plt.scatter(predict_val_test, response_test, color = "r",s=5) 
plt.xlabel("Predicted value")
plt.ylabel("Actual value")
plt.legend(["train set","test set"])
plt.show()

#In here plot the error vs actual val

plt.scatter( response_train,error_train, color ='b', s=5)
plt.scatter( response_test,error_test, color = "r",s=5) 
plt.xlabel("Actual value")
plt.ylabel("error")
plt.legend(["train set","test set"])
plt.show()