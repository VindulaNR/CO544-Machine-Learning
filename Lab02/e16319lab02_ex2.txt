#TODO 2


# -*- coding: utf-8 -*-
"""Lab02_03_logistic_regression.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/171lWug-l9ETk-uEI3Ed6Xwi2uP5-Mq9G
"""
#importing libraries

from sklearn import datasets
from sklearn.linear_model import LogisticRegression
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score

#loading digits data set
#part (i)

digit_dataset =datasets.load_digits() 
digit_dataset
x=digit_dataset["data"]
y=digit_dataset["target"]

#part (ii) splitig
x_train, x_test, y_train, y_test = train_test_split(x, y, test_size = 0.2, random_state = 1)
log_reg = LogisticRegression() 
log_reg.fit(x_train,y_train)

#part (iii) 
predictions_test = log_reg.predict(x_test)
predictions_test

predictions_train = log_reg.predict(x_train)
predictions_train

#part (iv)

import matplotlib.pyplot as plt
plt.scatter(predictions_train, y_train, color ='g', s=50, marker = "*")
plt.scatter(predictions_test, y_test, color = "r",s=3) 
plt.xlabel("Predicted value")
plt.ylabel("Actual value")
plt.legend(["train set","test set"])
plt.show()

print(accuracy_score(y_test, predictions))